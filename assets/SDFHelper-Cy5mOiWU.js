import{bi as V,bj as D,bk as L,bl as X,bm as Y}from"./index--P-vOJGN.js";const q=.45;function G(n,t=.5){switch(n.type){case"CIMPointSymbol":{const e=n.symbolLayers;if(!e||e.length!==1)return null;const o=e[0];return o.type!=="CIMVectorMarker"?null:G(o)}case"CIMVectorMarker":{const e=n.markerGraphics;if(!e||e.length!==1)return null;const o=e[0];if(!o)return null;const r=o.geometry;if(!r)return null;const i=o.symbol;return!i||i.type!=="CIMPolygonSymbol"&&i.type!=="CIMLineSymbol"||i.symbolLayers?.some(a=>!!a.effects)?null:{type:"sdf",geom:r,sdfPaddingRatio:t,asFill:i.type==="CIMPolygonSymbol"}}}}function U(n){return n?n.rings?n.rings:n.paths?n.paths:n.xmin!==void 0&&n.ymin!==void 0&&n.xmax!==void 0&&n.ymax!==void 0?[[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]]]:null:null}function B(n){let t=1/0,e=-1/0,o=1/0,r=-1/0;for(const i of n)for(const a of i)a[0]<t&&(t=a[0]),a[0]>e&&(e=a[0]),a[1]<o&&(o=a[1]),a[1]>r&&(r=a[1]);return new X(t,o,e-t,r-o)}function A(n){let t=1/0,e=-1/0,o=1/0,r=-1/0;for(const i of n)for(const a of i)a[0]<t&&(t=a[0]),a[0]>e&&(e=a[0]),a[1]<o&&(o=a[1]),a[1]>r&&(r=a[1]);return[t,o,e,r]}function E(n){return n?n.rings?A(n.rings):n.paths?A(n.paths):V(n)?[n.xmin,n.ymin,n.xmax,n.ymax]:null:null}function O(n,t){const[e,o,r,i]=E(n),a=r-e,l=i-o,c=D,m=L,s=Math.floor(.5*(c*t-m)),f=(c-2*(s+m))/Math.max(a,l),d=Math.round(a*f),h=Math.round(l*f);return{pixelDimensions:[a,l],texelDimensions:[Math.round((d+2*s)/f),Math.round((h+2*s)/f)]}}function Q(n,t,e,o,r,i,a){const[l,c,m,s]=n;if(m<l||s<c)return{frameSizeRatio:0,anchorX:0,anchorY:0,widthRatio:1,sdfPaddingRatio:.5};const f=m-l,d=s-c,h=Math.max(f,d);let u=.5;if(i!=null&&e!=null){!a&&t!=null&&(i*=(t.ymax-t.ymin)/e);const C=i/(i+h);C>q&&C<1&&(u=Math.min(C+.1,.99))}const x=D,M=L,p=Math.floor(.5*(x*u-M)),g=(x-2*(p+M))/h,I=Math.round(f*g)+2*p,R=Math.round(d*g)+2*p;let y=1;t&&(y=R*(1-u)/((t.ymax-t.ymin)*g));let w=0,b=0,P=1;o&&(r?t&&e&&t.ymax-t.ymin>0&&(P=(t.xmax-t.xmin)/(t.ymax-t.ymin),w=o.x/(e*P),b=o.y/e):(w=o.x,b=o.y)),t&&(w=.5*(t.xmax+t.xmin)+w*(t.xmax-t.xmin),b=.5*(t.ymax+t.ymin)+b*(t.ymax-t.ymin)),w-=l,b-=c,w*=g,b*=g,w+=p,b+=p;let S=w/I-.5,v=b/R-.5;return r&&e&&(S*=e*P,v*=e),{frameSizeRatio:y,anchorX:S,anchorY:v,widthRatio:P,sdfPaddingRatio:u}}function T(n){const t=U(n.geom),e=B(t),o=D,r=L,i=Math.floor(.5*(o*n.sdfPaddingRatio-r)),a=o-2*(i+r),l=a/Math.max(e.width,e.height),c=Math.round(e.width*l)+2*i,m=Math.round(e.height*l)+2*i,s=[];for(const d of t)if(d&&d.length>1){const h=[];for(const u of d){let[x,M]=u;x-=e.x,M-=e.y,x*=l,M*=l,x+=i-.5,M+=i-.5,n.asFill?h.push([x,M]):h.push([Math.round(x),Math.round(M)])}if(n.asFill){const u=h.length-1;h[0][0]===h[u][0]&&h[0][1]===h[u][1]||h.push(h[0])}s.push(h)}const f=H(s,c,m,i);return n.asFill&&J(s,c,m,i,f),{data:K(f,i),width:c,height:m,sdfPaddingRatio:n.sdfPaddingRatio,sdfDecodeCoeff:2*i/a}}function H(n,t,e,o){const r=t*e,i=new Array(r),a=o*o+1;for(let l=0;l<r;++l)i[l]=a;for(const l of n){const c=l.length;for(let m=1;m<c;++m){const s=l[m-1],f=l[m];let d,h,u,x;s[0]<f[0]?(d=s[0],h=f[0]):(d=f[0],h=s[0]),s[1]<f[1]?(u=s[1],x=f[1]):(u=f[1],x=s[1]);let M=Math.floor(d)-o,p=Math.floor(h)+o,g=Math.floor(u)-o,I=Math.floor(x)+o;M<0&&(M=0),p>t&&(p=t),g<0&&(g=0),I>e&&(I=e);const R=f[0]-s[0],y=f[1]-s[1],w=R*R+y*y;for(let b=M;b<p;b++)for(let P=g;P<I;P++){const S=b+.5,v=P+.5;let C,F,k=(S-s[0])*R+(v-s[1])*y;k<0?(C=s[0],F=s[1]):k>w?(C=f[0],F=f[1]):(k/=w,C=s[0]+k*R,F=s[1]+k*y);const j=(S-C)*(S-C)+(v-F)*(v-F),z=(e-P-1)*t+b;j<i[z]&&(i[z]=j)}}}for(let l=0;l<r;++l)i[l]=Math.sqrt(i[l]);return i}function J(n,t,e,o,r){for(const i of n){const a=i.length;for(let l=1;l<a;++l){const c=i[l-1],m=i[l];let s,f,d,h;c[0]<m[0]?(s=c[0],f=m[0]):(s=m[0],f=c[0]),c[1]<m[1]?(d=c[1],h=m[1]):(d=m[1],h=c[1]);let u=Math.floor(s),x=Math.floor(f)+1,M=Math.floor(d),p=Math.floor(h)+1;u<o&&(u=o),x>t-o&&(x=t-o),M<o&&(M=o),p>e-o&&(p=e-o);for(let g=M;g<p;++g){if(c[1]>g==m[1]>g)continue;const I=g+.5,R=(e-g-1)*t;for(let y=u;y<x;++y)y+.5<(m[0]-c[0])*(I-c[1])/(m[1]-c[1])+c[0]&&(r[R+y]=-r[R+y]);for(let y=o;y<u;++y)r[R+y]=-r[R+y]}}}}function K(n,t){const e=2*t,o=n.length,r=new Uint8Array(4*o);for(let i=0;i<o;++i){const a=.5-n[i]/e;Y(a,r,4*i)}return r}export{G as a,O as c,Q as h,E as m,T as u};
