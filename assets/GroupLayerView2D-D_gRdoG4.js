import{a2 as r,a3 as a,eT as o,a5 as d,d1 as V,W as l,gl as y,eS as p}from"./index--P-vOJGN.js";import{b as w}from"./LayerView2D-BK_gZ4lQ.js";import{d as u}from"./LayerView-of2LX4ZK.js";import"./Container-DmkRYSm8.js";let s=class extends u{constructor(e){super(e),this.type="group",this.layerViews=new V}destroy(){this.layerViews.length=0}_allLayerViewVisibility(e){this.layerViews.forEach(i=>{i.visible=e})}initialize(){this.addHandles([this.layerViews.on("change",e=>this._layerViewsChangeHandler(e)),l(()=>this.layer?.visibilityMode,()=>{this.layer&&this._applyVisibility(()=>this._allLayerViewVisibility(this.visible),()=>this._applyExclusiveVisibility(null))},y),l(()=>this.visible,e=>{this._applyVisibility(()=>this._allLayerViewVisibility(e),()=>{})},y)],"grouplayerview"),this._layerViewsChangeHandler({target:null,added:this.layerViews.toArray(),removed:[],moved:[]})}get creatingLayerViews(){return this.view?.layerViewManager?.isCreatingLayerViewsForLayer(this.layer)??!1}set layerViews(e){this._set("layerViews",p(e,this._get("layerViews")))}get updatingProgress(){return this.layerViews.length===0?1:this.layerViews.reduce((e,i)=>e+i.updatingProgress,0)/this.layerViews.length}isUpdating(){return this.creatingLayerViews||this.layerViews.some(e=>e.updating)}_hasLayerViewVisibleOverrides(){return this.layerViews.some(e=>e._isOverridden("visible"))}_findLayerViewForLayer(e){return e&&this.layerViews.find(i=>i.layer===e)}_firstVisibleOnLayerOrder(){const e=this.layer.layers.find(i=>!!this._findLayerViewForLayer(i)?.visible);return e&&this._findLayerViewForLayer(e)}_applyExclusiveVisibility(e){e==null&&(e=this._firstVisibleOnLayerOrder())==null&&this.layerViews.length>0&&(e=this._findLayerViewForLayer(this.layer.layers.at(0))),this.layerViews.forEach(i=>{i.visible=i===e})}_layerViewsChangeHandler(e){this.removeHandles("grouplayerview:visible"),this.addHandles(this.layerViews.map(t=>l(()=>t.visible,n=>this._applyVisibility(()=>{n!==this.visible&&(t.visible=this.visible)},()=>this._applyExclusiveVisibility(n?t:null)),y)).toArray(),"grouplayerview:visible");const i=e.added[e.added.length-1];this._applyVisibility(()=>this._allLayerViewVisibility(this.visible),()=>this._applyExclusiveVisibility(i?.visible?i:null))}_applyVisibility(e,i){this._hasLayerViewVisibleOverrides()&&(this.layer?.visibilityMode==="inherited"?e():this.layer?.visibilityMode==="exclusive"&&i())}};r([a({readOnly:!0})],s.prototype,"creatingLayerViews",null),r([a({cast:o})],s.prototype,"layerViews",null),r([a({readOnly:!0})],s.prototype,"updatingProgress",null),r([a()],s.prototype,"view",void 0),s=r([d("esri.views.layers.GroupLayerView")],s);let h=class extends w(s){attach(){this._updateStageChildren(),this.addAttachHandles(this.layerViews.on("after-changes",()=>this._updateStageChildren()))}detach(){this.container.removeAllChildren()}update(e){}viewChange(){}moveEnd(){}_updateStageChildren(){this.container.removeAllChildren(),this.layerViews.forEach((e,i)=>this.container.addChildAt(e.container,i))}};h=r([d("esri.views.2d.layers.GroupLayerView2D")],h);const c=h;export{c as default};
